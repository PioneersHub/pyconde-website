{% extends "layout.html" %}

{% block title %}{{ this.title }}{% endblock %}

{% block header %}
<!-- Google reCAPTCHA v2 -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
{% endblock %}

{% block body %}

<div class="subsite contact-page">
  <div class="subsite-title">
    <section class="content">
      <h2>{{ this.title }}</h2>
    </section>
  </div>

  <section class="content-block content-block--blue">
    <div class="content">
      {{ this.body }}
    </div>
  </section>

  <section class="content-block content-block--blue-light">
    <div class="content">
      <form id="contact-form" class="contact-form" novalidate>
        <div class="form-group">
          <label for="name">Name <span class="required">*</span></label>
          <input
            type="text"
            id="name"
            name="name"
            required
            maxlength="100"
            placeholder="Your full name"
            aria-required="true"
          >
          <span class="error-message" id="name-error"></span>
        </div>

        <div class="form-group">
          <label for="email">Email <span class="required">*</span></label>
          <input
            type="email"
            id="email"
            name="email"
            required
            maxlength="100"
            placeholder="your.email@example.com"
            aria-required="true"
          >
          <span class="error-message" id="email-error"></span>
        </div>

        <div class="form-group">
          <label for="topic">Topic <span class="required">*</span></label>
          <select
            id="topic"
            name="topic"
            required
            aria-required="true"
          >
            <option value="">Select a topic...</option>
            <option value="Program">Program</option>
            <option value="Tickets">Tickets</option>
            <option value="Sponsoring">Sponsoring</option>
            <option value="Financial Aid">Financial Aid</option>
            <option value="Partnering">Partnering</option>
            <option value="Other">Other</option>
          </select>
          <span class="error-message" id="topic-error"></span>
        </div>

        <div class="form-group">
          <label for="subject">Subject <span class="required">*</span></label>
          <input
            type="text"
            id="subject"
            name="subject"
            required
            maxlength="200"
            placeholder="What is your message about?"
            aria-required="true"
          >
          <span class="error-message" id="subject-error"></span>
        </div>

        <div class="form-group">
          <label for="message">Message <span class="required">*</span></label>
          <textarea
            id="message"
            name="message"
            required
            minlength="10"
            maxlength="5000"
            rows="8"
            placeholder="Your message (minimum 10 characters)"
            aria-required="true"
          ></textarea>
          <span class="character-count" id="message-count">0 / 5000</span>
          <span class="error-message" id="message-error"></span>
        </div>

        <!-- Honeypot field (hidden from users, bots will fill it) -->
        <div class="form-group honeypot" aria-hidden="true">
          <label for="website">Website</label>
          <input
            type="text"
            id="website"
            name="honeypot"
            tabindex="-1"
            autocomplete="off"
          >
        </div>

        <!-- reCAPTCHA widget -->
        <div class="form-group recaptcha-container">
          <div
            class="g-recaptcha"
            data-sitekey="{{ this.recaptcha_site_key }}"
            data-callback="onRecaptchaSuccess"
            data-expired-callback="onRecaptchaExpired"
          ></div>
          <span class="error-message" id="recaptcha-error"></span>
        </div>

        <div class="form-group">
          <button type="submit" class="submit-button" id="submit-button">
            <span class="button-text">Send Message</span>
            <span class="button-loader" style="display: none;">Sending...</span>
          </button>
        </div>

        <!-- Form messages -->
        <div id="form-success" class="form-message success-message" style="display: none;">
          <p>âœ“ Thank you for your message! We'll get back to you soon.</p>
        </div>
        <div id="form-error" class="form-message error-message-box" style="display: none;">
          <p id="form-error-text"></p>
        </div>
      </form>
    </div>
  </section>
</div>

<script>
  // Pass configuration from Lektor to JavaScript
  window.CONTACT_FORM_CONFIG = {
    apiEndpoint: "{{ this.api_endpoint }}",
    recaptchaSiteKey: "{{ this.recaptcha_site_key }}"
  };
</script>
<script src="{{ '/static/js/contact-form.js'|url }}"></script>

{% endblock %}
